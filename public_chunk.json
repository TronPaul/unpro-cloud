{
  "VPC" : {
    "Type" : "AWS::EC2::VPC",
    "Properties" : {
      "CidrBlock" : { "Ref" : "VPCCidr" },
      "EnableDnsHostnames" : "true",
      "Tags" : [
        { "Key" : "Application", "Value" : { "Ref" : "AWS::StackName" } },
        { "Key" : "Network", "Value" : "Public" }
      ]
    }
  },

  "TeamUnproHostedZone": {
    "Type": "AWS::Route53::HostedZone",
    "Properties": {
      "Name": "teamunpro.",
      "VPCS": [ { "Ref": "VPC" } ]
    }
  },

  "InternetGateway" : {
    "Type" : "AWS::EC2::InternetGateway",
    "Properties" : {
      "Tags" : [
        { "Key" : "Application", "Value" : { "Ref" : "AWS::StackName" } },
        { "Key" : "Network", "Value" : "Public" }
      ]
    }
  },

  "GatewayToInternet" : {
     "Type" : "AWS::EC2::VPCGatewayAttachment",
     "Properties" : {
       "VpcId" : { "Ref" : "VPC" },
       "InternetGatewayId" : { "Ref" : "InternetGateway" }
     }
  },

  "PublicRoute" : {
    "Type" : "AWS::EC2::Route",
    "DependsOn": "GatewayToInternet",
    "Properties" : {
      "RouteTableId" : { "Ref" : "PublicRouteTable" },
      "DestinationCidrBlock" : "0.0.0.0/0",
      "GatewayId" : { "Ref" : "InternetGateway" }
    }
  },

  "NATAllowICMP" : {
    "Type" : "AWS::EC2::SecurityGroupIngress",
    "Properties" : {
      "GroupId" : { "Ref" : "NATSecurityGroup" },
      "IpProtocol" : "icmp", 
	"FromPort" : "-1",  
	"ToPort" : "-1",  
	"SourceSecurityGroupId" : { "Ref" : "NATSecurityGroup" }
    }
  }
}
