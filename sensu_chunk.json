{
  "SubnetGroup": {
    "Type": "AWS::ElastiCache::SubnetGroup",
    "Properties": {
      "Description": "Cache Subnet Group",
      "SubnetIds": [ { "Ref": "PrivateSubnet" } ]
    }
  },

  "ElasticacheSecurityGroup": {
    "Type": "AWS::EC2::SecurityGroup",
    "Properties": {
      "GroupDescription": "Elasticache Security Group",
      "SecurityGroupIngress": [ {
        "IpProtocol": "tcp",
        "FromPort": 6379,
        "ToPort": 6379,
        "CidrIp": {"Ref": "VPCCidr"}
      } ],
      "VpcId": { "Ref": "VPC" }
    }
  },

  "ElasticacheCluster": {
    "Type": "AWS::ElastiCache::CacheCluster",
    "Properties": {
      "ClusterName": "sensu",
      "CacheSubnetGroupName": {"Ref": "SubnetGroup"},
      "CacheNodeType": "cache.t2.micro",
      "Engine": "redis",
      "NumCacheNodes": "1",
      "PreferredAvailabilityZone": "us-east-1c",
      "AutoMinorVersionUpgrade": "true",
      "VpcSecurityGroupIds": [{"Ref": "ElasticacheSecurityGroup"}]
    }
  }
}
